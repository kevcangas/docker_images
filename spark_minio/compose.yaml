services:
  # Servicio de Almacenamiento (Simulador S3)
  minio:
    image: minio/minio
    container_name: minio-s3
    environment:
      - MINIO_ROOT_USER=admin
      - MINIO_ROOT_PASSWORD=password
    command: server /data --console-address ":9001"
    ports:
      - "9000:9000" # API S3
      - "9001:9001" # Consola Web UI

  # Servicio de CÃ³mputo (Spark + Jupyter)
  spark-iceberg:
    image: jupyter/pyspark-notebook:spark-3.5.0
    container_name: spark-iceberg-lab
    ports:
      - "8888:8888" # Jupyter
      - "4040:4040" # Spark UI
    environment:
      # Credenciales para acceder a MinIO
      - AWS_ACCESS_KEY_ID=admin
      - AWS_SECRET_ACCESS_KEY=password
      - AWS_REGION=us-east-1
      - AWS_ENDPOINT_URL=http://minio:9000
    volumes:
      - ./notebooks:/home/jovyan/work
    depends_on:
      - minio